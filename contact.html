<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>HairCut - Hair Salon HTML Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="" name="keywords" />
    <meta content="" name="description" />

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon" />

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Oswald:wght@600&display=swap"
      rel="stylesheet"
    />

    <!-- Icon Font Stylesheet -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet" />
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet" />
    <script src="https://js.stripe.com/v3/"></script>
  </head>

  <body>
        <!-- Modal for Payment -->
    <!-- Modal for Payment -->
<!-- Modal for Payment -->
<div class="modal fade" id="paymentModal" tabindex="-1" aria-labelledby="paymentModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow-lg">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="paymentModalLabel">Secure Payment</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p class="text-muted mb-3">Please enter your payment details below to confirm your booking.</p>
        <div id="card-element" class="form-control p-3 rounded shadow-sm" style="border: 1px solid #ccc;">
          <!-- Stripe Element will be inserted here -->
        </div>
        <small id="card-errors" role="alert" class="text-danger mt-2 d-block"></small>
        <!-- Loader -->
        <div id="paymentLoader" class="text-center mt-3 d-none">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Processing...</span>
          </div>
          <p class="text-muted mt-2">Processing your payment, please wait...</p>
        </div>
      </div>
      <div class="modal-footer justify-content-between">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" id="confirmPaymentButton" class="btn btn-success">Confirm & Pay</button>
      </div>
    </div>
  </div>
</div>



    <!-- Spinner Start -->
    <div
      id="spinner"
      class="show bg-dark position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center"
    >
      <div
        class="spinner-grow text-primary"
        style="width: 3rem; height: 3rem"
        role="status"
      >
        <span class="sr-only">Loading...</span>
      </div>
    </div>
    <!-- Spinner End -->

    <!-- Navbar Start -->
    <nav
    class="navbar navbar-expand-lg bg-secondary navbar-dark sticky-top py-lg-0 px-lg-5 wow fadeIn"
    data-wow-delay="0.1s"
  >
    <a href="index.html" class="navbar-brand ms-4 ms-lg-0">
      <h1 class="mb-0 text-primary text-uppercase">
        <i class="fa fa-cut me-3"></i>HairCut
      </h1>
    </a>
    <button
      type="button"
      class="navbar-toggler me-4"
      data-bs-toggle="collapse"
      data-bs-target="#navbarCollapse"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <div
        class="navbar-nav ms-auto p-4 p-lg-0 text-center text-lg-end w-100 w-lg-auto"
      >
        <a href="index.html" class="nav-item nav-link">Home</a>
        <a href="about.html" class="nav-item nav-link">About</a>
        <a href="service.html" class="nav-item nav-link">Service</a>
        <!-- Uncomment the dropdown menu below if needed
    <div class="nav-item dropdown">
      <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Pages</a>
      <div class="dropdown-menu m-0">
        <a href="price.html" class="dropdown-item">Pricing Plan</a>
        <a href="team.html" class="dropdown-item">Our Barber</a>
        <a href="open.html" class="dropdown-item">Working Hours</a>
        <a href="testimonial.html" class="dropdown-item">Testimonial</a>
        <a href="404.html" class="dropdown-item">404 Page</a>
      </div>
    </div> -->
      </div>
      <div class="text-center text-lg-end w-100 w-lg-auto mt-3 mt-lg-0">
        <a href="contact.html" class="btn btn-primary rounded-0 py-2 px-lg-4">
          Appointment<i class="fa fa-arrow-right ms-3"></i>
        </a>
      </div>
    </div>
  </nav>
  
    <!-- Navbar End -->

    <!-- Page Header Start -->
    <div
      class="container-fluid page-header py-5 mb-5 wow fadeIn"
      data-wow-delay="0.1s"
    >
      <div class="container text-center py-5">
        <h1
          class="display-3 text-white text-uppercase mb-3 animated slideInDown"
        >
          Book Appointment
        </h1>
        <nav aria-label="breadcrumb animated slideInDown">
          <ol class="breadcrumb justify-content-center text-uppercase mb-0">
            <li class="breadcrumb-item">
              <a class="text-white" href="#">Home</a>
            </li>
            <li class="breadcrumb-item">
              <a class="text-white" href="#">Pages</a>
            </li>
            <li class="breadcrumb-item text-primary active" aria-current="page">
              Book Appointment
            </li>
          </ol>
        </nav>
      </div>
    </div>
    <!-- Page Header End -->

    <!-- Contact Start -->
    <div class="container-xxl py-5">
      <div class="container">
        <div class="row g-0">
          <di class="col-lg-6 wow fadeIn" data-wow-delay="0.1s">
            <div class="bg-secondary p-5">
              <p class="d-inline-block bg-dark text-primary py-1 px-4">
                Book Appointment
              </p>
              <h1 class="text-uppercase mb-4">
                Want to book appointment? Please book!
              </h1>
              <!-- <p class="mb-4">
                The contact form is currently inactive. Get a functional and
                working contact form with Ajax & PHP in a few minutes. Just copy
                and paste the files, add a little code and you're done.
                <a href="https://htmlcodex.com/contact-form">Download Now</a>.
              </p> -->
              <div id="successMessage" class="alert alert-success d-none" role="alert">
                Your appointment has been booked successfully!
              </div>
              <form id="appointmentForm">
                <div class="row g-3">
                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="text"
                        class="form-control bg-transparent"
                        id="name"
                        name="name"
                        placeholder="Your Name"
                        required
                      />
                      <label for="name">Your Name</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-floating">
                      <input
                        type="email"
                        class="form-control bg-transparent"
                        id="email"
                        name="email"
                        placeholder="Your Email"
                        required
                      />
                      <label for="email">Your Email</label>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="form-floating">
                      <input
                        type="text"
                        class="form-control bg-transparent"
                        id="contactNo"
                        name="contactNo"
                        placeholder="Contact Number"
                        required
                      />
                      <label for="contactNo">Contact Number</label>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="form-floating">
                      <input
                        type="date"
                        class="form-control bg-transparent"
                        id="bookingDate"
                        name="bookingDate"
                        placeholder="Booking Date"
                        required
                      />
                      <label for="bookingDate">Booking Date</label>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="form-floating">
                      <select
                        class="form-control bg-transparent"
                        id="bookingTime"
                        name="bookingTime"
                        required
                      >
                        <option value="" disabled selected>Select Booking Time</option>
                        <option value="10:00 AM">10:00 AM</option>
                        <option value="11:00 AM">11:00 AM</option>
                        <option value="12:00 PM">12:00 PM</option>
                        <option value="01:00 PM">01:00 PM</option>
                        <option value="02:00 PM">02:00 PM</option>
                        <option value="03:00 PM">03:00 PM</option>
                        <option value="04:00 PM">04:00 PM</option>
                      </select>
                      <label for="bookingTime">Booking Time</label>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="form-floating">
                      <textarea
                        class="form-control bg-transparent"
                        id="message"
                        name="message"
                        placeholder="Your Message"
                        style="height: 100px"
                      ></textarea>
                      <label for="message">Message (Optional)</label>
                    </div>
                  </div>
                  <div class="col-12">
                    <!-- <div id="card-element" class="form-control bg-transparent">
               
                    </div> -->
                    <div id="card-errors" role="alert" class="text-danger"></div>
                  </div>
                  <div class="col-12">
                    <button class="btn btn-primary w-100 py-3" type="submit">
                      Book Appointment
                    </button>
                  </div>
                </div>
                </div>
              </form>
              
            </div>
          </di v>
          <!-- <div class="col-lg-6 wow fadeIn" data-wow-delay="0.5s">
            <div class="h-100" style="min-height: 400px">
              <iframe
                class="google-map w-100 h-100"
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3001156.4288297426!2d-78.01371936852176!3d42.72876761954724!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x4ccc4bf0f123a5a9%3A0xddcfc6c1de189567!2sNew%20York%2C%20USA!5e0!3m2!1sen!2sbd!4v1603794290143!5m2!1sen!2sbd"
                frameborder="0"
                allowfullscreen=""
                aria-hidden="false"
                tabindex="0"
                style="
                  filter: grayscale(100%) invert(92%) contrast(83%);
                  border: 0;
                "
              ></iframe>
            </div>
          </div> -->
        </div>
      </div>
    </div>
    <!-- Contact End -->

    <!-- Footer Start -->
    <div
      class="container-fluid bg-secondary text-light footer mt-5 pt-5 wow fadeIn"
      data-wow-delay="0.1s"
    >
      <div class="container py-5">
        <div class="row g-5">
          <div class="col-lg-4 col-md-6">
            <h4 class="text-uppercase mb-4">Get In Touch</h4>
            <div class="d-flex align-items-center mb-2">
              <div class="btn-square bg-dark flex-shrink-0 me-3">
                <span class="fa fa-map-marker-alt text-primary"></span>
              </div>
              <span>123 Street, New York, USA</span>
            </div>
            <div class="d-flex align-items-center mb-2">
              <div class="btn-square bg-dark flex-shrink-0 me-3">
                <span class="fa fa-phone-alt text-primary"></span>
              </div>
              <span>+012 345 67890</span>
            </div>
            <div class="d-flex align-items-center">
              <div class="btn-square bg-dark flex-shrink-0 me-3">
                <span class="fa fa-envelope-open text-primary"></span>
              </div>
              <span>info@example.com</span>
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <h4 class="text-uppercase mb-4">Quick Links</h4>
            <a class="btn btn-link" href="">About Us</a>
            <a class="btn btn-link" href="">Contact Us</a>
            <a class="btn btn-link" href="">Our Services</a>
            <a class="btn btn-link" href="">Terms & Condition</a>
            <a class="btn btn-link" href="">Support</a>
          </div>
          <div class="col-lg-4 col-md-6">
            <h4 class="text-uppercase mb-4">Newsletter</h4>
            <div class="position-relative mb-4">
              <input
                class="form-control border-0 w-100 py-3 ps-4 pe-5"
                type="text"
                placeholder="Your email"
              />
              <button
                type="button"
                class="btn btn-primary py-2 position-absolute top-0 end-0 mt-2 me-2"
              >
                SignUp
              </button>
            </div>
            <div class="d-flex pt-1 m-n1">
              <a class="btn btn-lg-square btn-dark text-primary m-1" href=""
                ><i class="fab fa-twitter"></i
              ></a>
              <a class="btn btn-lg-square btn-dark text-primary m-1" href=""
                ><i class="fab fa-facebook-f"></i
              ></a>
              <a class="btn btn-lg-square btn-dark text-primary m-1" href=""
                ><i class="fab fa-youtube"></i
              ></a>
              <a class="btn btn-lg-square btn-dark text-primary m-1" href=""
                ><i class="fab fa-linkedin-in"></i
              ></a>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
        <div class="copyright">
          <div class="row">
            <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
              &copy; <a class="border-bottom" href="#">Your Site Name</a>, All
              Right Reserved.
            </div>
            <div class="col-md-6 text-center text-md-end">
              <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
              Designed By
              <!-- <a class="border-bottom" href="https://htmlcodex.com"
                >HTML Codex</a
              > -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Footer End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-primary btn-lg-square back-to-top"
      ><i class="bi bi-arrow-up"></i
    ></a>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>

    <script>
      // Initialize Stripe with your publishable key
      const stripe = Stripe('pk_test_51QKvyMFClduunNvlGHxOt4IA6TA78cx32sErS09UmEPmM16eRN0zhwQ88WltjY08Grb6y95M3XsxQLAoXnP6lhUF00f8lVuYtU');
      const elements = stripe.elements();
      const card = elements.create('card');
      card.mount('#card-element');
    
      // Store form data globally to use after successful payment
      let formData = {};
    
      // Handle form submission to open the payment modal
      document.getElementById('appointmentForm').addEventListener('submit', async function (event) {
        event.preventDefault();
    
        formData = {
          name: document.getElementById('name').value,
          email: document.getElementById('email').value,
          contactNo: document.getElementById('contactNo').value,
          bookingDate: document.getElementById('bookingDate').value,
          bookingTime: document.getElementById('bookingTime').value,
          message: document.getElementById('message').value
        };
    
        // Show the payment modal
        const paymentModal = new bootstrap.Modal(document.getElementById('paymentModal'));
        paymentModal.show();
      });
    
      // Handle payment confirmation
      document.getElementById('confirmPaymentButton').addEventListener('click', async function () {
        // Show loader
        const loader = document.getElementById('paymentLoader');
        loader.classList.remove('d-none');
        const confirmPaymentButton = document.getElementById('confirmPaymentButton');
        confirmPaymentButton.disabled = true;
    
        try {
          // Step 1: Create a payment intent on the server
          const paymentIntentResponse = await fetch('https://hair-saloon-backend.vercel.app/api/create-payment-intent', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ amount: 500 }) // Specify the amount in the smallest currency unit (e.g., cents for USD)
          });
          const { clientSecret } = await paymentIntentResponse.json();
    
          // Step 2: Use Stripe.js to handle payment confirmation
          const { error, paymentIntent } = await stripe.confirmCardPayment(clientSecret, {
            payment_method: {
              card: card,
              billing_details: {
                name: formData.name,
                email: formData.email
              }
            }
          });
    
          if (error) {
            // Handle payment error
            displayErrorMessage(`Payment failed: ${error.message}`);
            return;
          }
    
          if (paymentIntent.status === 'succeeded') {
            // Payment successful, proceed with booking the appointment
            const response = await fetch('https://hair-saloon-backend.vercel.app/api/user/book-appointment', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify(formData)
            });
    
            if (response.ok) {
              const result = await response.json();
              // Display success message
              const successMessage = document.getElementById('successMessage');
              successMessage.classList.remove('d-none');
              successMessage.innerText = 'Your appointment has been booked successfully!';
    
              // Clear the form
              document.getElementById('appointmentForm').reset();
    
              // Optionally hide the message after a few seconds
              setTimeout(() => {
                successMessage.classList.add('d-none');
              }, 5000); // Hides the message after 5 seconds
    
              // Close the modal
              const paymentModal = bootstrap.Modal.getInstance(document.getElementById('paymentModal'));
              paymentModal.hide();
            } else {
              displayErrorMessage('Failed to book appointment. Please try again.');
            }
          } else {
            displayErrorMessage('Payment was not successful. Please try again.');
          }
        } catch (error) {
          console.error('Error:', error);
          displayErrorMessage('An error occurred while processing your payment. Please try again later.');
        } finally {
          // Hide loader and re-enable button
          loader.classList.add('d-none');
          confirmPaymentButton.disabled = false;
        }
      });
    
      function displayErrorMessage(message) {
        const errorElement = document.getElementById('card-errors');
        errorElement.textContent = message;
      }
    </script>
    
  </body>
</html>
